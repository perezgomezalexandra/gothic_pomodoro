<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reloj Digital Gótico — Notion Widget</title>
<style>
  :root{
    --bg:#0b0b10;
    --text:#e8e8ea;
    --muted:#a1a1aa;
    --accent:#b300ff;      /* morado neón por defecto */
    --accent-2:#ff0040;    /* rojo magenta */
    --card:rgba(10,10,14,0.55);
    --blur:1.5px;
    --grain:0.35;
    --radius:16px;
    --shadow:0 10px 30px rgba(0,0,0,0.55), inset 0 0 0 1px rgba(255,255,255,0.06);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  .wrap{position:relative;min-height:100%;display:grid;place-items:center;overflow:hidden}
  .bg{position:absolute;inset:0;background:var(--bg) center/cover no-repeat;filter:blur(var(--blur));transform:scale(1.03)}
  .vignette{position:absolute;inset:-10%;pointer-events:none;
    background:radial-gradient(ellipse at center, rgba(0,0,0,0) 0%, rgba(0,0,0,0.15) 45%, rgba(0,0,0,0.6) 100%),
               linear-gradient(60deg, rgba(179,0,255,0.06), rgba(255,0,64,0.06))}
  .grain{position:absolute;inset:0;pointer-events:none;opacity:var(--grain);
    background-image:url('data:image/svg+xml;utf8,\
      <svg xmlns="http://www.w3.org/2000/svg" width="120" height="120">\
        <filter id="n"><feTurbulence baseFrequency="0.8" numOctaves="2" seed="7" type="fractalNoise"/></filter>\
        <rect width="100%" height="100%" filter="url(%23n)"></rect>\
      </svg>');
    background-size:160px 160px;mix-blend-mode:overlay}
  .card{position:relative;width:min(620px,94vw);padding:22px 18px;border-radius:var(--radius);
    background:var(--card);backdrop-filter:blur(8px) saturate(120%);box-shadow:var(--shadow);
    border:1px solid rgba(255,255,255,0.08)}
  .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;gap:12px}
  .title{font-weight:800;letter-spacing:.3px;display:flex;gap:10px;align-items:center}
  .badge{font-size:12px;padding:4px 8px;border-radius:999px;color:var(--accent);
    background:rgba(179,0,255,0.12);border:1px solid rgba(179,0,255,0.25)}
  .main{display:grid;gap:8px;justify-items:center;text-align:center}
  .clock{
    display:grid;gap:10px;justify-items:center;
    text-shadow:0 0 18px rgba(179,0,255,0.35);
  }
  .time{
    font-variant-numeric:tabular-nums; font-weight:900; line-height:1;
    font-size: clamp(42px, 12vw, 96px);
    letter-spacing: 4px;
  }
  .colon{ display:inline-block; width: .65em; text-align:center }
  .neon{
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text; background-clip:text; color:transparent;
    text-shadow:0 0 22px rgba(179,0,255,0.45), 0 0 38px rgba(255,0,64,0.25);
  }
  .date{font-size: clamp(14px, 3.6vw, 18px); color:var(--muted)}
  .tz{font-size:12px;color:var(--muted);opacity:.9}
  .controls{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
  .chip{
    appearance:none;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.02);
    color:var(--text);padding:6px 10px;border-radius:999px;font-size:13px;cursor:pointer;transition:.15s
  }
  .chip.active{border-color:var(--accent);color:var(--accent);box-shadow:inset 0 0 0 1px var(--accent)}
  @media (max-width:380px){ .time{letter-spacing:3px} }
</style>
</head>
<body>
<div class="wrap" role="application">
  <div class="bg" id="bg"></div>
  <div class="vignette"></div>
  <div class="grain"></div>

  <div class="card" aria-label="Reloj digital">
    <div class="header">
      <div class="title">⛧ Reloj <span class="badge">gothic</span></div>
      <div class="controls" aria-label="Controles">
        <button class="chip" id="toggle24">24 h</button>
        <button class="chip" id="toggleSec">Segundos</button>
      </div>
    </div>

    <div class="main">
      <div class="clock" aria-live="polite">
        <div class="time neon" id="time">00<span class="colon">:</span>00<span id="sec">00</span></div>
        <div class="date" id="date">—</div>
        <div class="tz" id="tz">—</div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  const qs = (s, el=document)=>el.querySelector(s);
  const setVar = (k,v)=>document.documentElement.style.setProperty(k, v);
  const params = new URLSearchParams(location.search);

  // Theming por parámetros
  const bgUrl = params.get('bg');
  const accent = params.get('accent');
  const text = params.get('text');
  const blur = params.get('blur');
  const grain = params.get('grain');

  if (bgUrl) qs('#bg').style.backgroundImage = `url("${bgUrl}")`;
  if (accent) setVar('--accent', accent);
  if (text) setVar('--text', text);
  if (blur) setVar('--blur', `${parseFloat(blur)}px`);
  if (grain) setVar('--grain', Math.max(0, Math.min(1, parseFloat(grain))));

  // Preferencias
  const pref = {
    h24: (params.get('h24') ?? '').toLowerCase() === 'true',
    seconds: (params.get('seconds') ?? '').toLowerCase() !== 'false', // por defecto sí
  };
  try{
    const saved = JSON.parse(localStorage.getItem('goth-clock')||'{}');
    Object.assign(pref, saved);
  }catch{}

  // Elementos
  const timeEl = qs('#time');
  const dateEl = qs('#date');
  const tzEl = qs('#tz');
  const secSpan = qs('#sec');
  const colon = qs('.colon');
  const btn24 = qs('#toggle24');
  const btnSec = qs('#toggleSec');

  function setActive(el, on){ el.classList.toggle('active', !!on); }

  setActive(btn24, pref.h24);
  setActive(btnSec, pref.seconds);
  secSpan.style.display = pref.seconds ? 'inline' : 'none';

  // Formateos
  const WEEK = ['domingo','lunes','martes','miércoles','jueves','viernes','sábado'];
  const MONTH = ['enero','febrero','marzo','abril','mayo','junio','julio','agosto','septiembre','octubre','noviembre','diciembre'];

  function pad(n){ return n.toString().padStart(2,'0'); }

  function render(){
    const now = new Date();
    let h = now.getHours();
    const m = now.getMinutes();
    const s = now.getSeconds();

    if(!pref.h24){
      h = h % 12; if(h === 0) h = 12;
    }

    timeEl.firstChild.nodeValue = pad(h);
    colon.style.opacity = (s % 2 ? 0.35 : 1); // parpadeo suave
    timeEl.childNodes[1].nodeValue = ':'; // asegura el separador
    timeEl.childNodes[2].nodeValue = pad(m);
    if(pref.seconds) secSpan.textContent = pad(s);

    // Fecha
    dateEl.textContent = `${WEEK[now.getDay()]}, ${now.getDate()} de ${MONTH[now.getMonth()]} de ${now.getFullYear()}`;

    // Zona horaria legible
    try {
      const tz = Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC';
      const offsetMin = now.getTimezoneOffset();
      const sign = offsetMin <= 0 ? '+' : '-';
      const abs = Math.abs(offsetMin);
      const hh = String(Math.floor(abs/60)).padStart(2,'0');
      const mm = String(abs%60).padStart(2,'0');
      tzEl.textContent = `${tz} (UTC${sign}${hh}:${mm})`;
    } catch {
      tzEl.textContent = 'Zona horaria';
    }
  }

  // Intervalo estable (requestAnimationFrame solo para el colon)
  setInterval(render, 500);
  function blink(){ colon.style.transform = 'translateY(0)'; requestAnimationFrame(blink) }
  render(); blink();

  // Controles
  btn24.addEventListener('click', ()=>{
    pref.h24 = !pref.h24; setActive(btn24, pref.h24); persist();
    render();
  });
  btnSec.addEventListener('click', ()=>{
    pref.seconds = !pref.seconds; setActive(btnSec, pref.seconds);
    secSpan.style.display = pref.seconds ? 'inline' : 'none'; persist();
  });

  function persist(){ localStorage.setItem('goth-clock', JSON.stringify(pref)); }
})();
</script>
</body>
</html>